<header>
  <div class="header-container">
    <div class="logo-container">
      <div class="logo-image">
        <img src="/assets/logo.png">
      </div>
      <div class="logo">
        <h1>Leucosia Luxury Suites</h1>
        <p>Eleganza e Comfort</p>
      </div>
    </div>
    <nav>
      <ul>
        <li><a [routerLink]="[]" fragment="home" [class.active]="currentSection === 'home'">Home</a></li>
        <li><a [routerLink]="[]" fragment="servizi" [class.active]="currentSection === 'servizi'">Servizi</a></li>
        <li><a [routerLink]="[]" fragment="camere" [class.active]="currentSection === 'camere'">Camere</a></li>
        <li><a [routerLink]="[]" fragment="recensioni" [class.active]="currentSection === 'recensioni'">Recensioni</a></li>
        <li><a [routerLink]="[]" fragment="contatti" [class.active]="currentSection === 'contatti'">Contatti</a></li>
      </ul>
    </nav>

    <!-- Bottone Login (visibile solo se NON loggato) -->
    <div *ngIf="!showMenu">
      <a mat-button routerLink="/login" class="profilo-link">
        <mat-icon>person</mat-icon> Profilo
      </a>
    </div>

    <!-- Bottone Profilo con mat-menu (visibile solo se loggato) -->
    <div *ngIf="showMenu">
      <button mat-button [matMenuTriggerFor]="profileMenu" class="profilo-link">
        <mat-icon>person</mat-icon> Profilo
      </button>

      <mat-menu #profileMenu="matMenu">
        <button mat-menu-item routerLink="/profilo">
          <mat-icon>person</mat-icon>
          <span> Profilo </span>
        </button>

        <button *ngIf="utenteOrAdmin() === 'admin'" mat-menu-item routerLink="/gestione_camere">
          <mat-icon>bed</mat-icon>
          <span> Gestione Camere </span>
        </button>

        <button mat-menu-item routerLink="/gestione_prenotazioni">
          <mat-icon>calendar_today</mat-icon>
          <span> Gestione Prenotazioni </span>
        </button>

        <button mat-menu-item routerLink="/news">
          <mat-icon>article</mat-icon>
          <span *ngIf="utenteOrAdmin() === 'admin'; else newsUser"> Gestione News </span>
          <ng-template #newsUser> News </ng-template>
        </button>

        <button mat-menu-item [routerLink]="utenteOrAdmin() === 'admin' ? '/gestione_messaggi' : '/richiedi_intervento'">
          <mat-icon>build</mat-icon>
          <span *ngIf="utenteOrAdmin() === 'admin'; else interventoUser"> Gestione Messaggi </span>
          <ng-template #interventoUser> Richiedi intervento </ng-template>
        </button>

        <button *ngIf="utenteOrAdmin() === 'utente'" mat-menu-item (click)="openRecensionePopup()">
          <mat-icon>rate_review</mat-icon>
          <span> Lascia una recensione </span>
        </button>

        <button mat-menu-item (click)="logout()">
          <mat-icon>logout</mat-icon>
          <span> Logout </span>
        </button>
      </mat-menu>
    </div>

    <div class="booking-button">
      <a class="btn" href="/prenotazione">Prenota Ora</a>
    </div>
  </div>
</header>

<section class="hero" id="home">
  <div class="hero-content">
    <h2>Benvenuti nel paradiso del relax</h2>
    <p>Un'esperienza indimenticabile nella splendida cornice della costa ionica</p>
    <a href="/prenotazione" class="btn">Scopri le nostre offerte</a>
  </div>
</section>

<section class="services" id="servizi">
  <div class="container">
    <h2 class="section-title">I Nostri Servizi</h2>
    <div class="services-grid">
      <div class="service-card">
        <mat-icon>pool</mat-icon>
        <h3>Piscina Panoramica</h3>
        <p>Rilassati nella nostra piscina con vista mozzafiato sul mare</p>
      </div>
      <div class="service-card">
        <mat-icon>restaurant</mat-icon>
        <h3>Colazione Gourmet</h3>
        <p>Gusta sapori dolci e salati con ingredienti freschi a km 0</p>
      </div>
      <div class="service-card">
        <mat-icon>spa</mat-icon>
        <h3>Oasi del Benessere</h3>
        <p>Ritrova il tuo equilibrio con i nostri trattamenti wellness</p>
      </div>
      <div class="service-card">
        <mat-icon>waves</mat-icon>
        <h3>Spiaggia Privata sul Mar Ionio</h3>
        <p>Goditi la bellezza e la tranquillità della costa ionica </p>
      </div>
    </div>
  </div>
</section>

<section class="rooms" id="camere">
  <div class="container">
    <h2 class="section-title">Le Nostre Camere</h2>
    <div class="rooms-scroll">
      <div class="room-card" *ngFor="let camera of camere">
        <div class="room-image" [ngStyle]="{ 'background-image': 'url(/assets/' + camera.id + '.jpg)' }"></div>
        <div class="room-info">
          <h3>{{ camera.nome }}</h3>
          <p>{{ camera.descrizione }}</p>
          <div class="room-features">
            <span><mat-icon>person</mat-icon> {{ camera.postiLetto }} persone</span>
            <span><mat-icon>open_in_full</mat-icon> {{ camera.metriQuadri }}m²</span>
            <span><mat-icon>wifi</mat-icon> Wi-Fi</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="testimonials" id="recensioni">
  <div class="container">
    <h2 class="section-title">Cosa Dicono i Nostri Ospiti</h2>
    <div class="testimonials-scroll">
      <div class="testimonial-card" *ngFor="let recensione of recensioni">
        <div class="stars">
          <mat-icon *ngFor="let star of [].constructor(recensione.stelle)">star</mat-icon>
        </div>
        <p class="testimonial-text">"{{ recensione.commento }}"</p>
        <p class="testimonial-author">- {{ recensione.nome }} {{ recensione.cognome }}</p>
      </div>
    </div>
  </div>
</section>

<section class="contact-section" id="contatti">
  <div class="container">
    <h2 class="section-title">Contattaci</h2>
    <div class="contact-container">
      <div class="contact-card">
        <mat-icon>location_on</mat-icon>
        <h3>Indirizzo</h3>
        <p>Via Pechino, snc<br>87064, Corigliano Calabro, Italia</p>
      </div>
      <div class="contact-card">
        <mat-icon>email</mat-icon>
        <h3>Email</h3>
        <p>leucosialuxurysuites&#64;gmail.com</p>
      </div>
      <div class="contact-card">
        <mat-icon>phone</mat-icon>
        <h3>Telefono</h3>
        <p>+39 0983 889674</p>
      </div>
      <div class="contact-card">
        <mat-icon>smartphone</mat-icon>
        <h3>Cellulare</h3>
        <p>+39 389 2347941</p>
      </div>
    </div>
  </div>
</section>

<div *ngIf="loadingCamere || loadingRecensioni || loadingSubmit" class="loading-overlay">
  <div class="spinner"></div>
  <p>Caricamento in corso...</p>
</div>


<div *ngIf="popupMessage" class="popup-overlay">
  <div class="popup-box">
    <p>{{ popupMessage }}</p>
    <button (click)="chiudiPopup()" class="btn btn-primary">OK</button>
  </div>
</div>

<app-footer></app-footer>

<app-recensione
  [isVisible]="showRecensionePopup"
  (closePopup)="closeRecensionePopup()"
  (submitReview)="onSubmitReview($event)">
</app-recensione>
